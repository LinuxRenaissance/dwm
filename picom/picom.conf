##########################################
# Picom config for DWM (OpenBSD/Linux)
# Smooth focus fade + dim inactive windows
##########################################

backend = "glx";                 # Use GPU acceleration (OpenGL)
vsync = true;                    # Prevent tearing
detect-rounded-corners = true;
detect-client-opacity = true;
unredir-if-possible = true;      # Unredirect fullscreen windows for performance

##########################################
# Shadows
##########################################
shadow = true;
shadow-radius = 12;
shadow-offset-x = -8;
shadow-offset-y = -8;
shadow-opacity = 0.6;
shadow-exclude = [
  "name = 'Notification'",
  "class_g = 'Conky'",
  "class_g = 'Polybar'",
  "class_g = 'dmenu'",
  "class_g = 'dwm'",
  "_GTK_FRAME_EXTENTS@:c"
];

##########################################
# Fade animations
##########################################
fading = true;                   # Enable fade-in/out animations
fade-in-step = 0.035;            # Fade-in speed
fade-out-step = 0.035;           # Fade-out speed
fade-delta = 10;                 # Animation smoothness (lower = smoother)

# Exclude these apps from fading (e.g., panels, menus)
fade-exclude = [
  "class_g = 'dmenu'",
  "class_g = 'slstatus'",
  "class_g = 'dwm'"
];

##########################################
# Opacity and inactive window dimming
##########################################
active-opacity = 1.0;            # Active window fully opaque
#inactive-opacity = 0.80;         # Inactive windows slightly transparent
inactive-dim = 0.4;             # Dim inactive windows slightly (dark overlay)
inactive-dim-fixed = false;      # Dimming adapts based on window brightness
frame-opacity = 1.0;             # Window borders fully opaque

# This hack makes dwm statusbar opaque
focus-exclude = "x = 0 && y = 0 && override_redirect = true";

##########################################
# Per-application opacity rules
##########################################
opacity-rule = [
  "80:class_g = 'XTerm'",
  "100:class_g = 'firefox'",
  "85:class_g = 'st-256color'"
];

##########################################
# Rounded corners
##########################################
corner-radius = 10;
round-borders = 1;

##########################################
# Performance tuning
##########################################
use-damage = true;               # Enable damage tracking (better performance)
glx-no-stencil = true;           # Slightly improves performance
xrender-sync-fence = true;       # Prevents potential screen tearing
